package me.aggellos2001.survivaleuplugin.modules;

import me.aggellos2001.survivaleuplugin.languages.Language;
import me.aggellos2001.survivaleuplugin.utils.PluginActivity;
import me.aggellos2001.survivaleuplugin.utils.Utilities;
import org.bukkit.Bukkit;
import org.bukkit.event.EventHandler;
import org.bukkit.event.player.PlayerCommandPreprocessEvent;

public final class PaySelfExploitEvent  extends PluginActivity {

	@Override
	public boolean hasEvents() {
		return true;
	}

	@Override
	public boolean hasCommands() {
		return false;
	}

	@EventHandler(ignoreCancelled = true)
	private void onPaying(final PlayerCommandPreprocessEvent e) {

		if (!e.getMessage().startsWith("/pay")) return;
		final var arguments = e.getMessage().split("\\s+");
		if (arguments.length == 1) return;
		final var sender = e.getPlayer();

		if (Utilities.isPlayerName(arguments[1])) {
			final var receiver = Bukkit.getPlayer(arguments[1]);
			if (receiver == null) return;
			if (sender.getAddress() == null || receiver.getAddress() == null) return;

			if (sender.getAddress().equals(receiver.getAddress())) {
				Utilities.sendMsg(sender,Language.PAYSELF_EXPLOIT.getTranslation(sender));
				e.setCancelled(true);
			}
		}
	}
}

